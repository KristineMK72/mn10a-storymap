<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>District 10A Story Map ‚Äì Bernie Penner</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    html, body {
      margin: 0;
      height: 100%;
      font-family: "Segoe UI", Arial, sans-serif;
      overflow: hidden;
    }

    .container {
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    .sidebar {
      background: #fafafa;
      padding: 15px;
      border-bottom: 1px solid #ddd;
      overflow-y: auto;
    }

    .map-container {
      flex-grow: 1;
      position: relative;
    }

    #map {
      height: 60vh;
      width: 100%;
    }

    .photo {
      width: 100%;
      border-radius: 10px;
      margin: 10px 0;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }

    @media (min-width: 769px) {
      .container {
        flex-direction: row;
      }

      .sidebar {
        width: 420px;
        border-right: 1px solid #ddd;
        border-bottom: none;
        height: 100vh;
      }

      .map-container {
        flex-grow: 1;
        height: 100vh;
      }

      #map {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }

      #search-form {
        position: absolute;
        top: 15px;
        left: 15px;
        z-index: 1000;
        width: 360px;
        background: rgba(255,255,255,0.95);
        padding: 8px 10px;
        border-radius: 8px;
        box-shadow: 0 3px 8px rgba(0,0,0,0.25);
      }
    }

    #search-input {
      width: 70%;
      padding: 7px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    #search-btn {
      padding: 7px 12px;
      background: #0078D7;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    #search-btn:hover {
      background: #005ea6;
    }

    a.map-link {
      color: #005ea6;
      text-decoration: none;
    }

    a.map-link:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>

<div class="container">
  <!-- Sidebar Content -->
  <div class="sidebar">
    <h2><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/Flag_of_Minnesota.svg/320px-Flag_of_Minnesota.svg.png" width="30" style="vertical-align:middle;margin-right:8px;"> Bernie Penner for District 10A</h2>
    
    <img src="https://upload.wikimedia.org/wikipedia/commons/2/22/Mille_Lacs_Lake_MN_sunset.jpg" alt="Mille Lacs Lake at sunset" class="photo">

    <p><b>Welcome!</b> Explore central Minnesota‚Äôs lake country and communities that make up House District 10A. This story map highlights demographics, major issues, and opportunities for growth championed by <b>Bernie Penner</b>.</p>

    <h4>Demographics (ACS 2023)</h4>
    <ul>
      <li>Population: ~40,000</li>
      <li>Median Household Income: $62,000</li>
      <li>Major Employers: CLC, Essentia Health, Manufacturing, Tourism</li>
    </ul>

    <h4>Key Issues</h4>
    <ul>
      <li>Local economic development and small business growth</li>
      <li>Infrastructure and broadband access</li>
      <li>Education funding and teacher support</li>
      <li>Protecting natural resources and clean lakes</li>
    </ul>

    <h4>Town Halls & City Links</h4>
    <ul>
      <li><a href="https://www.ci.brainerd.mn.us/" target="_blank">Brainerd City Hall</a></li>
      <li><a href="https://www.baxtermn.gov/" target="_blank">Baxter City Hall</a></li>
      <li><a href="https://www.cityofnisswa.com/" target="_blank">Nisswa Community Center</a></li>
      <li><a href="https://www.cityofaitkin.com/" target="_blank">Aitkin City Hall</a></li>
      <li><a href="https://www.cityofdeerwood.com/" target="_blank">Deerwood City Hall</a></li>
      <li><a href="https://www.cityofcrosby.com/" target="_blank">Crosby City Hall</a></li>
      <li><a href="https://www.pequotlakes-mn.gov/" target="_blank">Pequot Lakes City Hall</a></li>
    </ul>

    <img src="https://upload.wikimedia.org/wikipedia/commons/3/33/Brainerd_City_Hall.jpg" alt="Brainerd City Hall" class="photo">
    <img src="https://upload.wikimedia.org/wikipedia/commons/9/9f/Baxter_MN_water_tower.jpg" alt="Baxter Water Tower" class="photo">
    <img src="https://upload.wikimedia.org/wikipedia/commons/b/bb/Nisswa_Turtle_Races.jpg" alt="Nisswa Turtle Races" class="photo">

    <h4>Upcoming Events</h4>
    <p>üìÖ <b>Town Hall ‚Äì Dec 15, 2025</b><br>üìç Brainerd City Hall, 6:00 PM</p>
  </div>

  <!-- Map Container -->
  <div class="map-container">
    <form id="search-form">
      <input type="text" id="search-input" placeholder="Enter address (e.g. 123 Main St, Brainerd)" />
      <button type="submit" id="search-btn">Search</button>
    </form>
    <div id="map"></div>
  </div>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  const map = L.map('map').setView([46.45, -94.2], 9);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  const locations = [
    { name: "Brainerd City Hall", coords: [46.358, -94.200], url: "https://www.ci.brainerd.mn.us/" },
    { name: "Baxter City Hall", coords: [46.343, -94.286], url: "https://www.baxtermn.gov/" },
    { name: "Nisswa Community Center", coords: [46.521, -94.288], url: "https://www.cityofnisswa.com/" },
    { name: "Aitkin City Hall", coords: [46.534, -93.706], url: "https://www.cityofaitkin.com/" },
    { name: "Crosby City Hall", coords: [46.480, -93.957], url: "https://www.cityofcrosby.com/" },
    { name: "Deerwood City Hall", coords: [46.474, -93.896], url: "https://www.cityofdeerwood.com/" },
    { name: "Garrison City Hall", coords: [46.288, -93.823], url: "#" },
    { name: "Pequot Lakes City Hall", coords: [46.603, -94.309], url: "https://www.pequotlakes-mn.gov/" },
    { name: "Emily City Hall", coords: [46.740, -93.958], url: "#" }
  ];

  locations.forEach(loc => {
    L.marker(loc.coords).addTo(map)
      .bindPopup(`<b>${loc.name}</b><br><a href="${loc.url}" target="_blank" class="map-link">Visit Website</a>`);
  });

  const form = document.getElementById('search-form');
  const input = document.getElementById('search-input');
  let searchMarker = null;

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const query = input.value.trim();
    if (!query) return;

    const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}`;
    try {
      const response = await fetch(url);
      const data = await response.json();

      if (data.length > 0) {
        const { lat, lon, display_name } = data[0];
        const latNum = parseFloat(lat);
        const lonNum = parseFloat(lon);

        map.setView([latNum, lonNum], 15);

        if (searchMarker) map.removeLayer(searchMarker);
        searchMarker = L.marker([latNum, lonNum])
          .addTo(map)
          .bindPopup(`<b>${display_name}</b>`)
          .openPopup();
      } else {
        alert("Address not found. Try including city/state.");
      }
    } catch (err) {
      console.error("Geocoding error:", err);
      alert("Error fetching location.");
    }
  });

  window.addEventListener('load', () => {
    setTimeout(() => map.invalidateSize(), 500);
  });
</script>
</body>
</html>
